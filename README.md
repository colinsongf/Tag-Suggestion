# Tag-Suggestion
这部分实验模型代码是在[hed-dlg-truncated](https://github.com/julianser/hed-dlg-truncated)基础上进行修改的。不过他们的代码非常复杂，实现的功能也很多，我最终所用的部分其实很少。由于刚开始学习Theano时就接触到这份代码，当时也是一边参考theano官方文档一边学习这份代码的，最后索性自己的模型也就在这份代码的基础上进行搭建了。

========================================================

模型
--------------------------------------------------------
我所做的任务是社会媒体上的文本标签注释（简单的说就是给文本推荐标签），比如[知乎](https://www.zhihu.com/)，对于每个问题用户都会给出1~5个话题标签，而我希望通过构建一个模型能够自动根据用户的问题描述给出话题标签。知乎上大部分问题都会有问题的详细描述，我们把它视为是一个文本，由于是对文本进行建模，所以采用了层次化的深度神经网络（即先利用CNN模型从词学习得到句子的向量表示，再通过GRU模型从句子学习得到文本表示）。具体做法是，输入词向量利用CNN模型学习得到一个句子向量，然后再将句子向量输入到GRU中，将GRU的最后一个状态向量作为文本向量表示，最后接入一个sigmoid层（相当于构建多个sigmoid分类器），预测每个标签词的置信度。模型结构如下图所示，

![model](model.jpg?raw=true "model")

事实上，除了上述用CNN学习句子向量表示以外我们还尝试了用RNN（GRU）、char-rnn、Skip-Thought学习句子表示。

实验
--------------------------------------------------------
我们总共爬取了50W知乎数据，随机抽取了10万数据作为训练语料，5千作为测试语料，采用了两种评价指标PRF和R-Precision。目前我们评价的是模型预测生成的top-3的结果，以下是实验结果
|   模型               | P      | R      | P      | R-Precision  |
| -------------------- |:------:|:------:|:------:|:------------:|
| CNN+GRU(this code)   | 0.2828 | 0.3247 | 0.2828 | 0.2998       |
| GRU+GRU              | 0.2762 | 0.3173 | 0.2766 | 0.2957       |
| char-rnn+GRU         | 0.2828 | 0.3247 | 0.2828 | 0.2998       |
|Hierarchical Attention| 0.2732 | 0.3142 | 0.2732 | 0.2880       |